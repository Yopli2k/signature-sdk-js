import{M as m}from"./stu-sdk.min-DAnsK4yV.js";import{S as f,a as y}from"./stuCaptDialog-DTTpjUjJ.js";let r,n;try{r=await new m,document.getElementById("version_txt").innerHTML=r.VERSION,n=new r.SigObj;const a=n.setLicence("7c31f853-d5dd-48f1-8414-5ffe3c412f32","vi/z9ICyX1MB8sXMRdVhhN+XdVwovycD1jdE0PtWMejrQVSakuEoHNSgyi3sbdBuXTn7yZZ1jaokpuvA5yehfQ==");a.then(t=>{t&&(navigator.hid&&(document.getElementById("capture_stu_device").disabled=!1),document.getElementById("canvas_capture_btn").disabled=!1,document.getElementById("initializeBanground").style.display="none",document.getElementById("myfile").disabled=!1)}),a.catch(t=>{alert(t),document.getElementById("initializeBanground").style.display="none"})}catch(a){alert("Error initializing SigSDK "+a),document.getElementById("initializeBanground").style.display="none"}window.loadFromFile=async function(){const a=document.getElementById("myfile").files[0];if(a)if(a.type=="text/plain"){const t=new FileReader;t.onload=async function(){const c=t.result;try{await n.setTextData(c)?o():alert("Incorrect signature data found")}catch(i){alert("Error loading signature as text "+i)}},t.readAsText(a)}else if(a.type=="image/png"||a.type=="image/jpeg"){const t=new FileReader;t.onload=async function(){const c=t.result;var i=new Image;i.addEventListener("load",async function(){const e=document.createElement("canvas").getContext("webgl2");e.activeTexture(e.TEXTURE0);const d=e.createTexture();e.bindTexture(e.TEXTURE_2D,d);const u=e.createFramebuffer();e.bindFramebuffer(e.FRAMEBUFFER,u),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,d,0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),e.drawBuffers([e.COLOR_ATTACHMENT0]);const l=new Uint8Array(this.width*this.height*4);e.readPixels(0,0,this.width,this.height,e.RGBA,e.UNSIGNED_BYTE,l);try{await n.readEncodedBitmapBinary(l,i.width,i.height),o()}catch(g){alert("Error loading image "+g)}},!1),i.src=c},t.readAsDataURL(a)}else{const t=new FileReader;t.onload=async function(){const c=t.result;try{await n.setSigData(new Uint8Array(c))?o():alert("Incorrect signature data found")}catch(i){alert("Error loading signature as binary "+i)}},t.readAsArrayBuffer(a)}};async function o(){let a=Math.trunc(96*n.getWidth(!1)*.01/25.4),t=Math.trunc(96*n.getHeight(!1)*.01/25.4),c=300/a,i=200/t,s=Math.min(c,i),e=Math.trunc(a*s);const d=Math.trunc(t*s);e%4!=0&&(e+=e%4);const u="#000F55";try{const l=await n.renderBitmap(e,d,"image/png",4,u,"white",0,0,4194304);document.getElementById("sig_image").src=l,document.getElementById("sig_text").value=await n.getTextData(r.TextFormat.BASE64)}catch(l){alert(l)}}window.captureFromCanvas=function(){const a={};a.source={mouse:document.getElementById("allow_mouse_check").checked,touch:document.getElementById("allow_touch_check").checked,pen:document.getElementById("allow_pen_check").checked};const t=new f(r,a);t.addEventListener("ok",function(){o()}),t.open(n,null,null,null,r.KeyType.SHA512,null),t.startCapture()};window.captureFromSTU=function(){const a=new y(r);a.addEventListener("ok",function(){o()}),a.open(n,null,null,null,r.KeyType.SHA512,null)};
